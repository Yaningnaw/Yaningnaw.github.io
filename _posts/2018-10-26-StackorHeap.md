---
layout: post
title: '操作系统Stack和Heap的概念简述'
subtitle: '0.0 the crazy overflow'
date: 2018-10-26
categories: 技术
cover: '/assets/img/Earth.jpg'
tags: Java JVM
---
# Heap(堆)、Stack(栈)的概念 
>- 种数据结构。  
>- 都是一种按序排列的数据结构，只能在一端对数据项进行插入、删除操作
>- 单片机中的堆栈是特殊的存储区,负责暂存数据和地址，保护断点现场
- 堆，队列优先，先进先出（FIFO—first in first out）
- 栈，先进后出(FILO—First-In/Last-Out)。

# 堆和栈的区别
## 一、堆和栈分配空间的区别
- 操作系统中的堆：由操作系统自动分配释放 ，存放函数的参数值，局部变量的值等。其操作方式类似于数据结构中的栈；
- 操作系统中的栈： 一般由编程人员分配释放， 若编程人员不释放，程序结束时可能由OS回收，分配方式倒是类似于链表。

## 二、堆栈缓存方式区别（操作系统）
- 栈使用的是一级缓存，栈缓存数据被调用时处于存储空间中，调用完毕立即释放
- 堆是存放在二级缓存中的，所以调用这些对象的速度要相对来得低一些。

## 三、堆栈数据结构的区别（数据结构）
堆：对可以看成是一棵树，如堆排序
栈：一种后进先出的数据结构

## Java中栈和堆的区别 
- 栈（stack）和堆（heap）都是Java用来在RAM中存放数据的区间。与C++不同，Java自动管理堆和栈。
- 基本类型变量和对象的引用会在栈内存中分配  
>当在一段代码块定义一个变量时，Java就在栈中为这个变量分配内存空间，当超过变量的作用域后，Java会自动释放掉为该变量所分配的内存空间，该内存空间可以立即被另作他用。
- new创建的对象和数组的值等，在堆内存中分配内存，由Java虚拟机的垃圾回收机制管理 
>由Java虚拟机的自动垃圾回收器来管理。在堆中产生了一个数组或对象后，还可以在栈中定义一个特殊的变量，让栈中这个变量的取值等于数组或对象在堆内存中的首地址，栈中的这个变量就成了数组或对象的引用变量。引用变量就相当于是为数组或对象起的一个名称，以后就可以在程序中使用栈中的引用变量来访问堆中的数组或对象。 

### Java中变量在内存中的分配
1. 类变量（static修饰的变量）：在程序加载时在堆中为其开辟内存，其地址放于栈中以便高速访问。（静态变量生命周期一直持续到整个系统关闭）。
2. 实例变量：Java中new时，系统在堆中开辟并不一定是连续的空间分配给变量（比如说类实例），然后根据零散的堆内存地址，通过哈希算法换算为一长串数字以表征这个变量在堆中的”物理位置”。 实例变量的生命周期–当实例变量的引用丢失后，将被GC（垃圾回收器）列入可回收“名单”中，但并不是马上就释放堆中内存。 
3. 局部变量：局部变量，由声明在某方法，或某代码段里（比如for循环），执行到它的时候在栈中开辟内存，当局部变量一但脱离作用域，内存立即释放